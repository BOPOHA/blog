<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Ssh on No.Try not. Do… or do not. There is no try.</title><link>https://blog.vorona.me/categories/ssh/</link><description>Recent content in Ssh on No.Try not. Do… or do not. There is no try.</description><generator>Hugo</generator><language>en-us</language><copyright>Copyright © 2020–2022, Anatolii Vorona; all rights reserved.</copyright><lastBuildDate>Mon, 12 Oct 2020 11:42:40 +0100</lastBuildDate><atom:link href="https://blog.vorona.me/categories/ssh/index.xml" rel="self" type="application/rss+xml"/><item><title>Find Who Is Logged in by Ssh Key Fingerprint</title><link>https://blog.vorona.me/posts/2020-10-12-find-who-is-logged-in-by-ssh-key-fingerprint/</link><pubDate>Mon, 12 Oct 2020 11:42:40 +0100</pubDate><guid>https://blog.vorona.me/posts/2020-10-12-find-who-is-logged-in-by-ssh-key-fingerprint/</guid><description>&lt;h1 id="old-debian-based-os"&gt;Old debian based OS&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-shell" data-lang="shell"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;$ grep &lt;span style="color:#e6db74"&gt;&amp;#39;Accepted publickey&amp;#39;&lt;/span&gt; /var/log/auth.log
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;...
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;Oct &lt;span style="color:#ae81ff"&gt;12&lt;/span&gt; 07:09:05 &amp;lt;hostname&amp;gt; sshd&lt;span style="color:#f92672"&gt;[&lt;/span&gt;54321&lt;span style="color:#f92672"&gt;]&lt;/span&gt;: Accepted publickey &lt;span style="color:#66d9ef"&gt;for&lt;/span&gt; &amp;lt;username&amp;gt; from &amp;lt;ip&amp;gt; port &lt;span style="color:#ae81ff"&gt;12345&lt;/span&gt; ssh2: ED25519 00:00:00:00:00:00:00:00:00:00:00:00:00:00
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;...
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-shell" data-lang="shell"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;sudo -i -u username sh -c &lt;span style="color:#e6db74"&gt;&amp;#39;cat ~/.ssh/authorized_keys | sed &amp;#34;s/^/localhost /&amp;#34; &amp;gt; /tmp/authorized_keys&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;ssh-keygen -l -f /tmp/authorized_keys | grep 00:00:00:00:00:00:00:00:00:00:00:00:00:00
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#ae81ff"&gt;256&lt;/span&gt; 00:00:00:00:00:00:00:00:00:00:00:00:00:00 user@example.com &lt;span style="color:#f92672"&gt;(&lt;/span&gt;ED25519&lt;span style="color:#f92672"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h1 id="modern-rheldebian-based-os"&gt;Modern RHEL/Debian based OS&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-shell" data-lang="shell"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;$ journalctl -u sshd | grep &lt;span style="color:#e6db74"&gt;&amp;#39;Accepted publickey&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;Oct &lt;span style="color:#ae81ff"&gt;12&lt;/span&gt; 01:02:04 &amp;lt;hostname&amp;gt; sshd&lt;span style="color:#f92672"&gt;[&lt;/span&gt;54321&lt;span style="color:#f92672"&gt;]&lt;/span&gt;: Accepted publickey &lt;span style="color:#66d9ef"&gt;for&lt;/span&gt; &amp;lt;username&amp;gt; from &amp;lt;ip&amp;gt; port &lt;span style="color:#ae81ff"&gt;12345&lt;/span&gt; ssh2: ECDSA SHA256:ABCDEFGabcdefgABCDEFGabcdefgABCDEFGabcdefg
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;Oct &lt;span style="color:#ae81ff"&gt;12&lt;/span&gt; 01:07:16 &amp;lt;hostname&amp;gt; sshd&lt;span style="color:#f92672"&gt;[&lt;/span&gt;54322&lt;span style="color:#f92672"&gt;]&lt;/span&gt;: Accepted publickey &lt;span style="color:#66d9ef"&gt;for&lt;/span&gt; &amp;lt;username&amp;gt; from &amp;lt;ip&amp;gt; port &lt;span style="color:#ae81ff"&gt;12346&lt;/span&gt; ssh2: RSA SHA256:abcdefgABCDEFGabcdefgABCDEFGabcdefgABCDEFG
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;Oct &lt;span style="color:#ae81ff"&gt;12&lt;/span&gt; 07:24:13 &amp;lt;hostname&amp;gt; sshd&lt;span style="color:#f92672"&gt;[&lt;/span&gt;54323&lt;span style="color:#f92672"&gt;]&lt;/span&gt;: Accepted publickey &lt;span style="color:#66d9ef"&gt;for&lt;/span&gt; &amp;lt;username&amp;gt; from &amp;lt;ip&amp;gt; port &lt;span style="color:#ae81ff"&gt;12347&lt;/span&gt; ssh2: RSA SHA256:DEFGabcdefgABCDEFGabcdefgABCDEFGabcdefgABC
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-shell" data-lang="shell"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;sudo -i -u username sh -c &lt;span style="color:#e6db74"&gt;&amp;#39;ssh-keygen -l -f ~/.ssh/authorized_keys&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#ae81ff"&gt;2048&lt;/span&gt; SHA256:abcdefgABCDEFGabcdefgABCDEFGabcdefgABCDEFG user1@example.com &lt;span style="color:#f92672"&gt;(&lt;/span&gt;RSA&lt;span style="color:#f92672"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#ae81ff"&gt;521&lt;/span&gt; SHA256:ABCDEFGabcdefgABCDEFGabcdefgABCDEFGabcdefg user2@example.com &lt;span style="color:#f92672"&gt;(&lt;/span&gt;ECDSA&lt;span style="color:#f92672"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#ae81ff"&gt;4096&lt;/span&gt; SHA256:DEFGabcdefgABCDEFGabcdefgABCDEFGabcdefgABC user3@example.com &lt;span style="color:#f92672"&gt;(&lt;/span&gt;RSA&lt;span style="color:#f92672"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</description></item><item><title>SSH Passwordless Login With Keychain</title><link>https://blog.vorona.me/posts/2020-10-10-ssh-passwordless-login-with-keychain/</link><pubDate>Sat, 10 Oct 2020 17:22:40 +0100</pubDate><guid>https://blog.vorona.me/posts/2020-10-10-ssh-passwordless-login-with-keychain/</guid><description>&lt;h1 id="install-keychain"&gt;Install Keychain&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-shell" data-lang="shell"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;dnf install keychain -y
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#75715e"&gt;# apt-get install keychain -y&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#75715e"&gt;# pkg install keychain -y&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h1 id="generate-a-new-ssh-key-if-not-exist"&gt;Generate a new ssh key if not exist&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-shell" data-lang="shell"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;ssh-keygen -t ecdsa-sha2-nistp256 -C $USERNAME -f ~/.ssh/$USERNAME
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Assign the pass phrase when prompted.&lt;/p&gt;
&lt;h1 id="how-to-use-keychain"&gt;How to use Keychain&lt;/h1&gt;
&lt;p&gt;Update your $HOME/.bash_profile file or simular initialization file for zsh, fish, etc.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-shell" data-lang="shell"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;vi $HOME/.bash_profile
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Append the following code:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-shell" data-lang="shell"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;alias sshkey_secured&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#e6db74"&gt;&amp;#34;keychain &lt;/span&gt;$USERNAME&lt;span style="color:#e6db74"&gt; --nogui --quiet --timeout 60 ; source ~/.keychain/&lt;/span&gt;$HOSTNAME&lt;span style="color:#e6db74"&gt;-sh&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;source ~/.keychain/$HOSTNAME-sh
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Run once in the same terminal to update environment:&lt;/p&gt;</description></item></channel></rss>