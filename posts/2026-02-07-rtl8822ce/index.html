<!doctype html><html><head lang=en><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><title>The Quest for a Secure Wi-Fi AP on Linux (Realtek Edition) - No.Try not. Do… or do not. There is no try.</title><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="I recently set out to turn my ThinkCentre into a high-security wireless access point. My goal was simple: spin up a dedicated AP for my VR setup using modern WPA3-SAE security.
The hardware? A Realtek RTL8822CE.
The result? A lesson in Linux driver limitations.
If you are trying to force WPA3 on a Realtek card and seeing supplicant-timeout errors, this guide is for you. Here is how I hit the wall, and the &ldquo;Maximum Security&rdquo; WPA2 configuration I used to fix it while staying FIPS-compliant."><meta property="og:image" content="https://blog.vorona.me/"><meta property="og:url" content="https://blog.vorona.me/posts/2026-02-07-rtl8822ce/"><meta property="og:site_name" content="No.Try not. Do… or do not. There is no try."><meta property="og:title" content="The Quest for a Secure Wi-Fi AP on Linux (Realtek Edition)"><meta property="og:description" content="I recently set out to turn my ThinkCentre into a high-security wireless access point. My goal was simple: spin up a dedicated AP for my VR setup using modern WPA3-SAE security.
The hardware? A Realtek RTL8822CE. The result? A lesson in Linux driver limitations.
If you are trying to force WPA3 on a Realtek card and seeing supplicant-timeout errors, this guide is for you. Here is how I hit the wall, and the “Maximum Security” WPA2 configuration I used to fix it while staying FIPS-compliant."><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2026-02-08T12:00:00+01:00"><meta property="article:modified_time" content="2026-02-08T12:00:00+01:00"><meta property="article:tag" content="Linux"><meta property="article:tag" content="Networking"><meta property="article:tag" content="Realtek"><meta property="article:tag" content="Security"><meta property="article:tag" content="Wpa3"><meta name=twitter:card content="summary"><meta name=twitter:title content="The Quest for a Secure Wi-Fi AP on Linux (Realtek Edition)"><meta name=twitter:description content="I recently set out to turn my ThinkCentre into a high-security wireless access point. My goal was simple: spin up a dedicated AP for my VR setup using modern WPA3-SAE security.
The hardware? A Realtek RTL8822CE. The result? A lesson in Linux driver limitations.
If you are trying to force WPA3 on a Realtek card and seeing supplicant-timeout errors, this guide is for you. Here is how I hit the wall, and the “Maximum Security” WPA2 configuration I used to fix it while staying FIPS-compliant."><link href=https://blog.vorona.me/css/fonts.2c2227b81b1970a03e760aa2e6121cd01f87c88586803cbb282aa224720a765f.css rel=stylesheet><link rel=stylesheet type=text/css media=screen href=https://blog.vorona.me/css/main.a87126a5d38398207e58225b2d1a9faf97f546982f44b3ffb9715a264da36c90.css></head><body><div class=content><header><div class=main><a href=https://blog.vorona.me/>No.Try not. Do… or do not. There is no try.</a></div><nav><a href=https://blog.vorona.me/>Home</a>
<a href=https://blog.vorona.me/posts/>All posts</a>
<a href=https://blog.vorona.me/tags/>Tags</a></nav></header><main><article><div class=post-container><div class=post-content><div class=title><h1 class=title>The Quest for a Secure Wi-Fi AP on Linux (Realtek Edition)</h1><div class=meta>Posted on Feb 8, 2026</div></div><section class=body><p>I recently set out to turn my ThinkCentre into a high-security wireless access point. My goal was simple: spin up a dedicated AP for my VR setup using modern <strong>WPA3-SAE</strong> security.</p><p>The hardware? A <strong>Realtek RTL8822CE</strong>.
The result? A lesson in Linux driver limitations.</p><p>If you are trying to force WPA3 on a Realtek card and seeing <code>supplicant-timeout</code> errors, this guide is for you. Here is how I hit the wall, and the &ldquo;Maximum Security&rdquo; WPA2 configuration I used to fix it while staying FIPS-compliant.</p><h2 id=the-problem-could-not-generate-wpa-ie>The Problem: &ldquo;Could not generate WPA IE&rdquo;</h2><p>I started by configuring a standard WPA3 Access Point using NetworkManager. My card claimed to support SAE (Simultaneous Authentication of Equals), so I ran:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>nmcli con modify <span style=color:#e6db74>&#34;VR_AP&#34;</span> wifi-sec.key-mgmt sae
</span></span><span style=display:flex><span>nmcli con modify <span style=color:#e6db74>&#34;VR_AP&#34;</span> wifi-sec.pmf required
</span></span></code></pre></div><p>It failed instantly. <code>journalctl</code> revealed the culprit:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>wpa_supplicant[921]: Note: nl80211 driver interface is not designed to be used with ap_scan=2
</span></span><span style=display:flex><span>wpa_supplicant[921]: Could not generate WPA IE.
</span></span><span style=display:flex><span>wpa_supplicant[921]: WPA initialization failed.
</span></span></code></pre></div><h3 id=why-this-happens>Why this happens</h3><p>While the <strong>RTL8822CE</strong> hardware theoretically supports WPA3, the Linux kernel driver (<code>rtw88</code>) currently struggles with it in <strong>AP Mode</strong>. It can <em>connect</em> to WPA3 networks as a client, but it crashes when trying to <em>advertise</em> one.</p><p>There are numerous threads on the <a href=https://lore.kernel.org/linux-wireless/>kernel wireless mailing lists</a> and <a href=https://bugzilla.redhat.com/>Red Hat Bugzilla</a> detailing similar issues with SoftAP mode on consumer cards.</p><h2 id=the-solution-fips-compliant-wpa2-aes>The Solution: FIPS-Compliant WPA2-AES</h2><p>Since &ldquo;Pure WPA3&rdquo; was off the table, the next best thing is <strong>WPA2-AES (CCMP)</strong> with <strong>Protected Management Frames (PMF)</strong>.</p><p>By strictly enforcing AES encryption and disabling the older TKIP protocol, we achieve a setup that is:</p><ol><li><strong>Stable</strong> on Realtek drivers.</li><li><strong>FIPS-Compliant</strong> (AES-only).</li><li><strong>Fast</strong> (802.11ac speeds).</li></ol><h3 id=step-1-unlock-5ghz-frequencies>Step 1: Unlock 5GHz Frequencies</h3><p>Before configuring the AP, I had to ensure my regulatory domain allowed 5GHz usage. By default, Linux often blocks AP mode on 5GHz to prevent radar interference.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Check your current setting</span>
</span></span><span style=display:flex><span>iw reg get
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Set it to your location (e.g., Montenegro &#39;ME&#39; or US &#39;US&#39;)</span>
</span></span><span style=display:flex><span>sudo iw reg set ME
</span></span></code></pre></div><h3 id=step-2-the-maximum-security-config>Step 2: The &ldquo;Maximum Security&rdquo; Config</h3><p>Here is the <code>nmcli</code> command sequence that finally worked. I forced <strong>Channel 36</strong> to avoid the 60-second DFS (radar detection) wait time that causes timeouts on many cards.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># 1. Clean slate</span>
</span></span><span style=display:flex><span>nmcli con delete <span style=color:#e6db74>&#34;VR_AP&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 2. Create the connection specifically on Channel 36 (Non-DFS)</span>
</span></span><span style=display:flex><span>nmcli con add type wifi ifname wlp1s0 con-name <span style=color:#e6db74>&#34;VR_AP&#34;</span> autoconnect yes ssid <span style=color:#e6db74>&#34;VR&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  802-11-wireless.mode ap <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  802-11-wireless.band a <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  802-11-wireless.channel <span style=color:#ae81ff>36</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 3. Security: Force WPA2-AES (CCMP Only)</span>
</span></span><span style=display:flex><span><span style=color:#75715e># This is the critical part. We explicitly disable TKIP.</span>
</span></span><span style=display:flex><span>nmcli con modify <span style=color:#e6db74>&#34;VR_AP&#34;</span> wifi-sec.key-mgmt wpa-psk
</span></span><span style=display:flex><span>nmcli con modify <span style=color:#e6db74>&#34;VR_AP&#34;</span> wifi-sec.psk <span style=color:#e6db74>&#34;YourSecretPassword&#34;</span>
</span></span><span style=display:flex><span>nmcli con modify <span style=color:#e6db74>&#34;VR_AP&#34;</span> wifi-sec.proto rsn
</span></span><span style=display:flex><span>nmcli con modify <span style=color:#e6db74>&#34;VR_AP&#34;</span> wifi-sec.pairwise ccmp
</span></span><span style=display:flex><span>nmcli con modify <span style=color:#e6db74>&#34;VR_AP&#34;</span> wifi-sec.group ccmp
</span></span><span style=display:flex><span>nmcli con modify <span style=color:#e6db74>&#34;VR_AP&#34;</span> 802-11-wireless.channel-width <span style=color:#ae81ff>80</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 4. PMF (Protected Management Frames)</span>
</span></span><span style=display:flex><span><span style=color:#75715e># I set this to &#39;optional&#39;. &#39;required&#39; crashed the Realtek driver.</span>
</span></span><span style=display:flex><span>nmcli con modify <span style=color:#e6db74>&#34;VR_AP&#34;</span> wifi-sec.pmf optional
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 5. Share the Internet</span>
</span></span><span style=display:flex><span>nmcli con modify <span style=color:#e6db74>&#34;VR_AP&#34;</span> ipv4.method shared
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 6. Launch</span>
</span></span><span style=display:flex><span>nmcli con up <span style=color:#e6db74>&#34;VR_AP&#34;</span>
</span></span></code></pre></div><h2 id=verification>Verification</h2><p>To prove that the insecure TKIP protocol was actually gone, I checked the running interface:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>iw dev wlp1s0 info
</span></span></code></pre></div><p><strong>Output:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>Interface wlp1s0
</span></span><span style=display:flex><span>    ifindex 3
</span></span><span style=display:flex><span>    wdev 0x1
</span></span><span style=display:flex><span>    addr 82:2a:a9:cc:aa:d6
</span></span><span style=display:flex><span>    ssid VR
</span></span><span style=display:flex><span>    type AP
</span></span><span style=display:flex><span>    channel 36 (5180 MHz), width: 80 MHz, center1: 5210 MHz
</span></span><span style=display:flex><span>    txpower 23.00 dBm
</span></span><span style=display:flex><span>    multicast TXQ:
</span></span><span style=display:flex><span>        qidx: 0
</span></span><span style=display:flex><span>        qlen: 0
</span></span></code></pre></div><p>Success! A stable, high-security AP running on hardware that fought me every step of the way.</p><h2 id=resources>Resources</h2><ul><li><a href="https://www.google.com/search?q=https://wireless.wiki.kernel.org/en/users/drivers/rtw88">Linux Kernel Wireless (rtw88)</a></li><li><a href=https://networkmanager.dev/docs/api/latest/nm-settings-nmcli.html>NetworkManager Wi-Fi Documentation</a></li><li><a href=https://www.wi-fi.org/discover-wi-fi/security>WPA3 SAE Explanation</a></li></ul></section><div class=post-tags><nav class="nav tags"><ul class=tags><li><a href=https://blog.vorona.me/tags/linux/>linux</a></li><li><a href=https://blog.vorona.me/tags/networking/>networking</a></li><li><a href=https://blog.vorona.me/tags/realtek/>realtek</a></li><li><a href=https://blog.vorona.me/tags/security/>security</a></li><li><a href=https://blog.vorona.me/tags/wpa3/>wpa3</a></li></ul></nav></div></div></div></article></main><footer><div style=display:flex><a class=soc href rel=me title=github><svg class="feather"><use href="https://blog.vorona.me/svg/feather-sprite.51cf5647cb1987f769b616558f2620fd9423d72058490231b391bf6aa3744b55.svg#%25!s%28%3cnil%3e%29"/></svg></a><a class=border></a><a class=soc href rel=me title=email><svg class="feather"><use href="https://blog.vorona.me/svg/feather-sprite.51cf5647cb1987f769b616558f2620fd9423d72058490231b391bf6aa3744b55.svg#%25!s%28%3cnil%3e%29"/></svg></a><a class=border></a></div><div class=footer-info>2026 Copyright © 2020–2022, Anatolii Vorona; all rights reserved. | <a href=https://github.com/athul/archie>Archie Theme</a> | Built with <a href=https://gohugo.io>Hugo</a></div></footer><script async src="https://www.googletagmanager.com/gtag/js?id=G-4NT8K1F5CV"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-4NT8K1F5CV")}</script></div></body></html>